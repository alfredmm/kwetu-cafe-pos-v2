{% extends "posApp/base.html" %}
{% block pageContent %}
<div class="d-flex justify-content-center align-items-center min-vh-100 bg-light">
    <div class="card shadow-lg p-4" style="min-width:350px; max-width:480px; width:100%;">
        <form id="user-form" autocomplete="off">
            {% csrf_token %}
            <h4 class="card-title text-center mb-4">{{ form_title }}</h4>
            
            <div class="form-group mb-3">
                <label for="username" class="form-label">Username</label>
                <input type="text" class="form-control" id="username" name="username" 
                       value="{% if user_obj %}{{ user_obj.username }}{% endif %}" required>
            </div>
            
            <div class="form-group mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" name="email" 
                       value="{% if user_obj %}{{ user_obj.email }}{% endif %}" required>
            </div>
            
            <div class="form-group mb-3">
                <label for="first_name" class="form-label">First Name</label>
                <input type="text" class="form-control" id="first_name" name="first_name" 
                       value="{% if user_obj %}{{ user_obj.first_name }}{% endif %}">
            </div>
            
            <div class="form-group mb-3">
                <label for="last_name" class="form-label">Last Name</label>
                <input type="text" class="form-control" id="last_name" name="last_name" 
                       value="{% if user_obj %}{{ user_obj.last_name }}{% endif %}">
            </div>
            
            {% if not user_obj %}
            <div class="form-group mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="password" class="form-control" id="password" name="password" required>
            </div>
            {% endif %}
            
            <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="is_active" name="is_active" 
                       {% if user_obj and user_obj.is_active or not user_obj %}checked{% endif %}>
                <label class="form-check-label" for="is_active">Active</label>
            </div>
            
            <div class="form-check mb-3">
                <input type="checkbox" class="form-check-input" id="is_staff" name="is_staff" 
                       {% if user_obj and user_obj.is_staff %}checked{% endif %}>
                <label class="form-check-label" for="is_staff">Staff status</label>
            </div>
            
            <button type="submit" class="btn btn-primary w-100">Save</button>
        </form>
    </div>
</div>
<style>
    body {
        background: #f8fafb !important;
    }
    .card {
        border-radius: 1rem;
        background: #fff;
    }
    .form-label {
        font-weight: 500;
    }
    .btn-primary {
        font-weight: 600;
        letter-spacing: 0.03em;
    }
    @media (max-width: 576px) {
        .card {
            min-width: 100% !important;
            max-width: 100% !important;
            padding: 1.5rem 0.5rem !important;
        }
    }
</style>
{% endblock pageContent %}

{% block ScriptBlock %}
<script>
    $(function() {
        $('#user-form').submit(function(e) {
            e.preventDefault();
            var form = $(this);
            var formData = form.serialize();
            
            $.ajax({
                url: window.location.href,
                method: 'POST',
                data: formData,
                dataType: 'json',
                success: function(resp) {
                    if(resp.success) {
                        alert_toast(resp.message, 'success');
                        setTimeout(function() {
                            $('#uni_modal').modal('hide');
                            location.reload();
                        }, 1500);
                    } else {
                        alert_toast(resp.message, 'error');
                    }
                },
                error: function(xhr) {
                    var resp = xhr.responseJSON;
                    alert_toast(resp && resp.message ? resp.message : "An error occurred", 'error');
                }
            });
        });
    });
</script>
{% endblock %}
